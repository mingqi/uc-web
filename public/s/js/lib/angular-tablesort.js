var tableSortModule=angular.module("tableSort",[]);tableSortModule.directive("tsWrapper",["$log","$parse",function(e,t){return{scope:!0,controller:["$scope",function(e){e.sortExpression=[],e.headings=[];var n=function(e){return[t(e),null,!1]};this.setSortField=function(t,r){var i,s=n(t);if(e.sortExpression.length===1&&e.sortExpression[0][0]===s[0])e.sortExpression[0][2]?(r.removeClass("tablesort-desc"),r.addClass("tablesort-asc"),e.sortExpression[0][2]=!1):(r.removeClass("tablesort-asc"),r.addClass("tablesort-desc"),e.sortExpression[0][2]=!0);else{for(i=0;i<e.headings.length;i+=1)e.headings[i].removeClass("tablesort-desc").removeClass("tablesort-asc");r.addClass("tablesort-asc"),e.sortExpression=[s]}},this.addSortField=function(t,r){var i,s=!1,o=n(t);for(i=0;i<e.sortExpression.length;i+=1)e.sortExpression[i][0]===o[0]&&(e.sortExpression[i][2]?(r.removeClass("tablesort-desc"),r.addClass("tablesort-asc"),e.sortExpression[i][2]=!1):(r.removeClass("tablesort-asc"),r.addClass("tablesort-desc"),e.sortExpression[i][2]=!0),s=!0);s||(r.addClass("tablesort-asc"),e.sortExpression.push(o))},this.registerHeading=function(t){e.headings.push(t)},e.sortFun=function(t,n){var r,i,s,o,u;for(r=0;r<e.sortExpression.length;r+=1){i=e.sortExpression[r][0](t),s=e.sortExpression[r][0](n),u=n[e.sortExpression[r][1]],u&&(i=u(i),s=u(s)),i===undefined&&(i=""),s===undefined&&(s=""),o=e.sortExpression[r][2];if(i>s)return o?-1:1;if(i<s)return o?1:-1}return 0}}]}}]),tableSortModule.directive("tsCriteria",function(){return{require:"^tsWrapper",link:function(e,t,n,r){var i=function(i){e.$apply(function(){i.shiftKey?r.addSortField(n.tsCriteria,t):r.setSortField(n.tsCriteria,t)})};t.bind("click",i),t.addClass("tablesort-sortable"),"tsDefault"in n&&n.tsDefault!=="0"&&(r.addSortField(n.tsCriteria,t),n.tsDefault=="descending"&&r.addSortField(n.tsCriteria,t)),r.registerHeading(t)}}}),tableSortModule.directive("tsRepeat",["$compile",function(e){return{terminal:!0,require:"^tsWrapper",priority:1e6,link:function(t,n){var r=n.clone(),i=n[0].childElementCount,s=r.attr("ng-repeat");s=s.replace(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(\s+track\s+by\s+[\s\S]+?)?\s*$/,"$1 in $2 | tablesortOrderBy:sortFun$3"),n.html("<td colspan='"+i+"'></td>"),n[0].className+=" showIfLast",r.removeAttr("ts-repeat"),r.attr("ng-repeat",s);var o=e(r)(t);n.after(o)}}}]),tableSortModule.filter("tablesortOrderBy",function(){return function(e,t){if(!e)return;var n=[];for(var r=0;r<e.length;r++)n.push(e[r]);return n.sort(t)}}),tableSortModule.filter("parseInt",function(){return function(e){return parseInt(e)}}),tableSortModule.filter("parseFloat",function(){return function(e){return parseFloat(e)}});